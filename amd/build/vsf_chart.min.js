/**
 * Progress Section Format
 *
 * @package    course/format
 * @subpackage vsf
 * @version    See the value of '$plugin->version' in version.php.
 * @copyright  2016 Gareth J Barnard
 * @author     G J Barnard - gjbarnard at gmail dot com and {@link http://moodle.org/user/profile.php?id=442195}
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define(["jquery","format_vsf/chartist","core/log"],function(a,b,c){"use strict";return c.debug("Progress Section Format Chartist AMD jQuery initialised"),function(b,c,d){var e={fillClass:"ct-fill-donut",label:{html:"<div></div>","class":"ct-fill-donut-label test"},items:[{}]};d.plugins=d.plugins||{},d.plugins.fillDonut=function(b){return b=d.extend({},e,b),function(c){if(c instanceof d.Pie){var e=a(c.container);e.css("position","relative");var f;c.on("draw",function(c){if("slice"==c.type){0==c.index&&(f=e.find("svg").eq(0));var d=a(c.group._node).clone();d.attr("class",d.attr("class")+" "+b.fillClass),d.find("path").each(function(){a(this).find("animate").remove(),a(this).removeAttr("stroke-dashoffset")}),f.prepend(d)}}),c.on("created",function(f){var g=0;c.options.fillDonutOptions&&(b=d.extend({},b,c.options.fillDonutOptions)),a.each(b.items,function(){var c=a(b.label.html).addClass(b.label["class"]),d=a.extend({},{"class":"",id:"",content:"fillText",position:"center",offsetY:0,offsetX:0},this);a(d.content);d.id.length>0&&c.attr("id",d.id),d["class"].length>0&&c.addClass("class",d["class"]),e.find('*[data-fill-index$="fdid-'+g+'"]').remove(),c.attr("data-fill-index","fdid-"+g),g++,c.append(d.content).css({position:"absolute"}),e.append(c);var f=e.innerWidth()/2,h=e.height()/2,i=c.innerWidth()/2,j=c.height()/2,k={bottom:{bottom:0+d.offsetY,left:f-i+d.offsetX},top:{top:0+d.offsetY,left:f-i+d.offsetX},left:{top:h-j+d.offsetY,left:0+d.offsetX},right:{top:h-j+d.offsetY,right:0+d.offsetX},center:{top:h-j+d.offsetY,left:f-i+d.offsetX}};c.css(k[d.position])})})}}}}(window,document,b),{init:function(d){c.debug("Progress Section Format Chartist AMD init initialised"),c.debug(d),a(document).ready(function(){var a={series:[60,40],labels:["",""]},c={donut:!0,donutWidth:40,startAngle:0,total:100,showLabel:!1,plugins:[b.plugins.fillDonut({items:[{content:'<i class="fa fa-tachometer"></i>',position:"bottom",offsetY:10,offsetX:-2},{content:'<h3>60<span class="small">%</span></h3>'}]})]},d=new b.Pie(".ct-chart",a,c);d.on("draw",function(a){if("slice"===a.type&&0==a.index){var c=a.element._node.getTotalLength();a.element.attr({"stroke-dasharray":c+"px "+c+"px"});var d={"stroke-dashoffset":{id:"anim"+a.index,dur:24e3,from:-c+"px",to:"0px",easing:b.Svg.Easing.easeOutQuint,fill:"freeze"}};a.element.attr({"stroke-dashoffset":-c+"px"}),a.element.animate(d,!0)}})})}}});